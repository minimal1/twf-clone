# 3.1 터미널 프로그래밍

## Raw 모드란?

### 내 답변

키보드 입력을 OS에서 가공하지않고 바이트 배열로 전달받아 처리하는 방식을 말합니다.  
이와 반대로 OS가 입력처리하는 Cooked 모드가 있으며 주로 Shell을 생각하시면 됩니다.

입력에 대한 매핑된 코드값들의 묶음을 처리하는 것으로 크게 4가지 유형의 코드값들을 다뤄야합니다.

1. ASCII 제어 코드
2. ASCII 문자 코드
3. ANSI 이스케이프 시퀀스 코드
4. 유니 코드

각 코드별 입력은 매번 버퍼에 전달되며, 전달된 크기는 상이합니다.  
아스키 코드는 1바이트, 유니코드는 1~4바이트, ANSI 이스케이프 시퀀스 코드는 최대 20바이트도 될 수 있습니다.  
이렇게 여러바이트를 한번에 처리해야하기에 버퍼의 크기도 잘 설정해야합니다.  
일반적으로 64바이트를 사용한다고 합니다.  
이는 CPU 캐시 라인 크기(64 bytes), Memory 활용성을 고려한 2의 제곱수 사용으로 인한 비트 연산 최적화 값이기 때문입니다.

코드를 파싱할 때는 각 코드별 특징이 있으니 그것을 활용하면 됩니다.  
주로 2,4번은 일반 문자에 해당하기에 어떤 기능을 담고있는 1,3번에 대해 처리하고 그 외는 모두 문자처리하도록 구성합니다.  
1, 3번은 코드표가 있기때문에 그것을 통해서 작성하면 됩니다.  
2, 4번은 go에선 범용적 문자타입 Rune을 활용하시면 됩니다.

이러한 특징과 활용을 가진 Raw 모드는 필히 사용을 마치면 꺼줘야합니다.  
그렇지않으면 터미널이 망가지게됩니다.

## ANSI 이스케이프 시퀀스란?

바이트 배열을 이용해 터미널에서 여러 기능을 수행할 수 있는 코드들을 말합니다.  
이스케이프 문자로 시작하여 중간에 CSI라는 문자를 두며 그 뒤에 최종 문자를 하나 둡니다.  
일반적으로 위 3가지 문자들의 구성으로 하나의 이스케이프 시퀀스 코드가 완성됩니다.  
커서의 이동, 스크린의 상태 관리, 텍스트의 색상을 보정하는 작업도 가능합니다.

## 대체 화면 버퍼란?

일종의 Layer된 새로운 화면입니다.  
기존 터미널을 망가뜨리면 안되기에 새로운 화면을 그 위에 얹습니다.  
그 화면은 대체 화면 버퍼라 합니다.  
그래서 TUI 프로그램에서는 대체 화면을 통해 기존 터미널과 격리된 공간에서 원하는 기능들을 수행하도록 설계합니다.  
프로그램이 종료되면 기존 터미널로 돌아가며 원래 상태가 보존되어있습니다.
